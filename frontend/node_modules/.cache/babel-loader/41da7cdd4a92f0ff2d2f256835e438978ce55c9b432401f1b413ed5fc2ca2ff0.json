{"ast":null,"code":"var _jsxFileName = \"/Users/lwi/Foodniverse3.0/frontend/src/pages/Auth/AuthPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport API from \"../../utils/api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthPage = () => {\n  _s();\n  const navigate = useNavigate();\n  const [step, setStep] = useState(0);\n  const [aiPrompt, setAiPrompt] = useState(\"Hi there ðŸ‘‹ I'm LUNA, your flavor guide. Can I get your email to get started?\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [userData, setUserData] = useState({});\n  const [isExistingUser, setIsExistingUser] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const prompts = [\"What should I call you?\", \"What's your vibe when it comes to food? (e.g. cozy, adventurous, spicy)\", \"Where are you based? (City)\", \"And your country?\", \"Create a password you'll remember ðŸ—ï¸\"];\n  const handleSubmit = async () => {\n    if (step === 0) {\n      const email = inputValue.trim().toLowerCase();\n      if (!email.includes(\"@\")) return alert(\"Please enter a valid email\");\n      setUserData({\n        email\n      });\n      setLoading(true);\n      try {\n        const res = await API.post(\"/auth/check\", {\n          email\n        });\n        setIsExistingUser(res.data.exists);\n        setAiPrompt(res.data.exists ? `Welcome back ðŸ‘‹ Just enter your password to continue` : prompts[0]);\n        setStep(1);\n      } catch (err) {\n        console.error(err);\n        alert(\"Error checking user\");\n      } finally {\n        setLoading(false);\n      }\n    } else if (isExistingUser && step === 1) {\n      // LOGIN FLOW\n      setLoading(true);\n      try {\n        const res = await API.post(\"/auth/login\", {\n          email: userData.email,\n          password: inputValue\n        });\n        localStorage.setItem(\"token\", res.data.token);\n        localStorage.setItem(\"userEmail\", res.data.email);\n        localStorage.setItem(\"username\", res.data.username);\n        navigate(`/${res.data.username}/feed`);\n      } catch (err) {\n        alert(\"Incorrect password\");\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      // SIGNUP FLOW\n      const keys = [\"name\", \"vibe\", \"city\", \"country\", \"password\"];\n      const key = keys[step - 1];\n      const newUserData = {\n        ...userData,\n        [key]: inputValue\n      };\n      setUserData(newUserData);\n      const nextStep = step + 1;\n      if (nextStep <= keys.length) {\n        setAiPrompt(prompts[step]);\n        setStep(nextStep);\n        setInputValue(\"\");\n      } else {\n        // FINALIZE SIGNUP\n        setLoading(true);\n        try {\n          const res = await API.post(\"/auth/register\", newUserData);\n          alert(\"âœ… Account created! Log in now.\");\n          window.location.reload();\n        } catch (err) {\n          alert(\"Something went wrong\");\n        } finally {\n          setLoading(false);\n        }\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-100 px-6\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white/70 backdrop-blur-md rounded-3xl shadow-xl max-w-xl w-full p-10 relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold text-gray-800 mb-6 animate-fadeInSlow\",\n        children: aiPrompt\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: step === 5 || isExistingUser && step === 1 ? \"password\" : \"text\",\n        className: \"w-full p-4 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-gray-700 text-lg shadow-sm\",\n        value: inputValue,\n        onChange: e => setInputValue(e.target.value),\n        onKeyDown: e => e.key === \"Enter\" && handleSubmit(),\n        disabled: loading,\n        autoFocus: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all\",\n        onClick: handleSubmit,\n        disabled: loading || !inputValue.trim(),\n        children: loading ? \"Please wait...\" : \"Next\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 95,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthPage, \"yNAU6LwRUlh+wU36/NvcrjCLat8=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthPage;\nexport default AuthPage;\nvar _c;\n$RefreshReg$(_c, \"AuthPage\");","map":{"version":3,"names":["React","useState","useNavigate","API","jsxDEV","_jsxDEV","AuthPage","_s","navigate","step","setStep","aiPrompt","setAiPrompt","inputValue","setInputValue","userData","setUserData","isExistingUser","setIsExistingUser","loading","setLoading","prompts","handleSubmit","email","trim","toLowerCase","includes","alert","res","post","data","exists","err","console","error","password","localStorage","setItem","token","username","keys","key","newUserData","nextStep","length","window","location","reload","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","value","onChange","e","target","onKeyDown","disabled","autoFocus","onClick","_c","$RefreshReg$"],"sources":["/Users/lwi/Foodniverse3.0/frontend/src/pages/Auth/AuthPage.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport API from \"../../utils/api\";\n\nconst AuthPage = () => {\n  const navigate = useNavigate();\n\n  const [step, setStep] = useState(0);\n  const [aiPrompt, setAiPrompt] = useState(\"Hi there ðŸ‘‹ I'm LUNA, your flavor guide. Can I get your email to get started?\");\n  const [inputValue, setInputValue] = useState(\"\");\n  const [userData, setUserData] = useState({});\n  const [isExistingUser, setIsExistingUser] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const prompts = [\n    \"What should I call you?\",\n    \"What's your vibe when it comes to food? (e.g. cozy, adventurous, spicy)\",\n    \"Where are you based? (City)\",\n    \"And your country?\",\n    \"Create a password you'll remember ðŸ—ï¸\",\n  ];\n\n  const handleSubmit = async () => {\n    if (step === 0) {\n      const email = inputValue.trim().toLowerCase();\n      if (!email.includes(\"@\")) return alert(\"Please enter a valid email\");\n      setUserData({ email });\n      setLoading(true);\n      try {\n        const res = await API.post(\"/auth/check\", { email });\n        setIsExistingUser(res.data.exists);\n        setAiPrompt(res.data.exists\n          ? `Welcome back ðŸ‘‹ Just enter your password to continue`\n          : prompts[0]\n        );\n        setStep(1);\n      } catch (err) {\n        console.error(err);\n        alert(\"Error checking user\");\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    else if (isExistingUser && step === 1) {\n      // LOGIN FLOW\n      setLoading(true);\n      try {\n        const res = await API.post(\"/auth/login\", {\n          email: userData.email,\n          password: inputValue,\n        });\n\n        localStorage.setItem(\"token\", res.data.token);\n        localStorage.setItem(\"userEmail\", res.data.email);\n        localStorage.setItem(\"username\", res.data.username);\n\n        navigate(`/${res.data.username}/feed`);\n      } catch (err) {\n        alert(\"Incorrect password\");\n      } finally {\n        setLoading(false);\n      }\n    }\n\n    else {\n      // SIGNUP FLOW\n      const keys = [\"name\", \"vibe\", \"city\", \"country\", \"password\"];\n      const key = keys[step - 1];\n      const newUserData = { ...userData, [key]: inputValue };\n      setUserData(newUserData);\n      const nextStep = step + 1;\n\n      if (nextStep <= keys.length) {\n        setAiPrompt(prompts[step]);\n        setStep(nextStep);\n        setInputValue(\"\");\n      } else {\n        // FINALIZE SIGNUP\n        setLoading(true);\n        try {\n          const res = await API.post(\"/auth/register\", newUserData);\n          alert(\"âœ… Account created! Log in now.\");\n          window.location.reload();\n        } catch (err) {\n          alert(\"Something went wrong\");\n        } finally {\n          setLoading(false);\n        }\n      }\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-100 px-6\">\n      <div className=\"bg-white/70 backdrop-blur-md rounded-3xl shadow-xl max-w-xl w-full p-10 relative\">\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-6 animate-fadeInSlow\">\n          {aiPrompt}\n        </h2>\n\n        <input\n          type={step === 5 || (isExistingUser && step === 1) ? \"password\" : \"text\"}\n          className=\"w-full p-4 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-400 text-gray-700 text-lg shadow-sm\"\n          value={inputValue}\n          onChange={(e) => setInputValue(e.target.value)}\n          onKeyDown={(e) => e.key === \"Enter\" && handleSubmit()}\n          disabled={loading}\n          autoFocus\n        />\n\n        <button\n          className=\"mt-6 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all\"\n          onClick={handleSubmit}\n          disabled={loading || !inputValue.trim()}\n        >\n          {loading ? \"Please wait...\" : \"Next\"}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default AuthPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}